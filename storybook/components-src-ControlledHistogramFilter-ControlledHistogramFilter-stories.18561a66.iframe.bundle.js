/*! For license information please see components-src-ControlledHistogramFilter-ControlledHistogramFilter-stories.18561a66.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkessex_toolkit_stories=self.webpackChunkessex_toolkit_stories||[]).push([[7898],{"../components/src/ControlledHistogramFilter/ControlledHistogramFilter.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,default:()=>ControlledHistogramFilter_stories});var jsx_runtime=__webpack_require__("../../.yarn/cache/react-npm-18.3.1-af38f3c1ae-261137d3f3.zip/node_modules/react/jsx-runtime.js"),react=__webpack_require__("../../.yarn/cache/react-npm-18.3.1-af38f3c1ae-261137d3f3.zip/node_modules/react/index.js"),lib_commonjs=__webpack_require__("../../.yarn/__virtual__/@fluentui-react-virtual-de7476e3d6/0/cache/@fluentui-react-npm-8.118.9-93c5d7c0a7-1806e7182f.zip/node_modules/@fluentui/react/lib-commonjs/index.js"),NumberSpinButton=__webpack_require__("../components/src/NumberSpinButton/NumberSpinButton.tsx"),enums=__webpack_require__("../../.yarn/__virtual__/@thematic-core-virtual-76f8edb146/0/cache/@thematic-core-npm-4.0.7-c127a4a6f7-258e1c254c.zip/node_modules/@thematic/core/dist/types/enums.js"),dist_layers=__webpack_require__("../../.yarn/__virtual__/@thematic-d3-virtual-edaaeda702/0/cache/@thematic-d3-npm-2.0.22-01fffb296c-2f9005e50f.zip/node_modules/@thematic/d3/dist/layers.js"),dist_svg=__webpack_require__("../../.yarn/__virtual__/@thematic-d3-virtual-edaaeda702/0/cache/@thematic-d3-npm-2.0.22-01fffb296c-2f9005e50f.zip/node_modules/@thematic/d3/dist/svg.js"),useThematic=__webpack_require__("../../.yarn/__virtual__/@thematic-react-virtual-1d715ad545/0/cache/@thematic-react-npm-2.1.9-5021c00aed-19e6347a18.zip/node_modules/@thematic/react/dist/useThematic.js"),bin=__webpack_require__("../../.yarn/cache/d3-array-npm-3.2.4-b427632bcc-5800c467f8.zip/node_modules/d3-array/src/bin.js"),max=__webpack_require__("../../.yarn/cache/d3-array-npm-3.2.4-b427632bcc-5800c467f8.zip/node_modules/d3-array/src/max.js"),axis=__webpack_require__("../../.yarn/cache/d3-axis-npm-3.0.0-81ef16a9a5-15ec43ecbd.zip/node_modules/d3-axis/src/axis.js"),src=__webpack_require__("../../.yarn/cache/d3-brush-npm-3.0.0-0f86c8ad35-fa3a461b62.zip/node_modules/d3-brush/src/index.js"),linear=__webpack_require__("../../.yarn/cache/d3-scale-npm-4.0.2-d17a53447b-e2dc424358.zip/node_modules/d3-scale/src/linear.js"),src_select=__webpack_require__("../../.yarn/cache/d3-selection-npm-3.0.0-39a42b4ca9-0e5acfd305.zip/node_modules/d3-selection/src/select.js");const DEFAULT_MARGINS={top:8,right:8,bottom:20,left:40},HistogramSelect=({width,height,data,numberOfBins,selectedRange,onRangeChanged,selectedFill,unselectedFill,margins})=>{const theme=(0,useThematic.t)(),minDataValue=(0,react.useMemo)((()=>Math.min(...data)),[data]),maxDataValue=(0,react.useMemo)((()=>Math.max(...data)),[data]),svgElementRef=(0,react.useRef)(null),chartElements=(0,react.useRef)(),correctedMargins={...DEFAULT_MARGINS,...margins};return(0,react.useEffect)((()=>{const element=svgElementRef.current;if(element){const svg=(0,src_select.A)(element),viewPort=svg.append("g"),plotArea=viewPort.append("g").append("rect"),xScale=(0,linear.A)(),reverseXScale=(0,linear.A)(),xAxis=viewPort.append("g"),yScale=(0,linear.A)(),yAxis=viewPort.append("g");chartElements.current={svg,viewPort,plotArea,xScale,reverseXScale,yScale,xAxis,yAxis,domain:[0,0],vpWidth:0,vpHeight:0}}}),[svgElementRef]),(0,react.useEffect)((()=>{const outerElements=chartElements.current;outerElements&&(outerElements.onBrushEnd=event=>{const elements=chartElements.current;if(elements){const brushSelection=elements.brushSelection;let newBrushSelection=event.selection;if(newBrushSelection){if(newBrushSelection=newBrushSelection.map(elements.reverseXScale),(!brushSelection||newBrushSelection[0]!==brushSelection[0]||newBrushSelection[1]!==brushSelection[1])&&(elements.brushSelection=newBrushSelection,onRangeChanged)){const newRange=[newBrushSelection[0],newBrushSelection[1]];newRange[0]===minDataValue&&(newRange[0]=void 0),newRange[1]===maxDataValue&&(newRange[1]=void 0),onRangeChanged(newRange)}}else brushSelection&&(elements.brushSelection=void 0,onRangeChanged&&onRangeChanged([void 0,void 0]))}})}),[chartElements,onRangeChanged,minDataValue,maxDataValue]),(0,react.useEffect)((()=>{const elements=chartElements.current;if(elements){const{svg,viewPort,plotArea,xScale,reverseXScale,xAxis,yScale}=elements,domain=[Math.min(...data),Math.max(...data)];elements.domain=domain;const vpWidth=width-correctedMargins.left-correctedMargins.right,vpHeight=height-correctedMargins.top-correctedMargins.bottom;elements.vpWidth=vpWidth,elements.vpHeight=vpHeight,svg.call(dist_layers.bW,theme,{width,height}),viewPort.attr("transform",`translate(${correctedMargins.left},${correctedMargins.top})`),plotArea.attr("width",vpWidth).attr("height",vpHeight).call(dist_svg.Pc,theme.plotArea()),xScale.domain(domain).range([0,vpWidth]),reverseXScale.domain([0,vpWidth]).range(domain),xAxis.call(dist_layers.yo,theme,(0,axis.l7)(xScale),{attr:{transform:`translate(0, ${vpHeight})`}}),yScale.range([vpHeight,0])}}),[chartElements,width,height,data,selectedRange,theme,correctedMargins.left,correctedMargins.right,correctedMargins.top,correctedMargins.bottom]),(0,react.useEffect)((()=>{if(!data.length)return;const elements=chartElements.current;if(elements&&numberOfBins){elements.viewPort.selectAll(".brush").remove();const bins=(0,bin.A)().domain(elements.domain).thresholds(numberOfBins)(data);elements.yScale.domain([0,(0,max.A)(bins,(d=>d.length))]),elements.yAxis.call(dist_layers.yo,theme,(0,axis.V4)(elements.yScale));const u=elements.viewPort.selectAll(".bars").data(bins);u.enter().append("rect").attr("class","bars").merge(u).attr("x",1).attr("transform",(d=>`translate(${elements.xScale(d.x0)},${elements.yScale(d.length)})`)).attr("width",(d=>Math.max(0,elements.xScale(d.x1)||0-(elements.xScale(d.x0)||0),-1))).attr("height",(d=>elements.vpHeight-(elements.yScale(d.length)||0))).style("fill",(d=>{const selectionStart=void 0!==selectedRange[0]?selectedRange[0]:minDataValue,selectionEnd=void 0!==selectedRange[1]?selectedRange[1]:maxDataValue;return void 0!==d.x0&&void 0!==d.x1&&d.x0<=selectionEnd&&d.x1>=selectionStart?selectedFill||theme.rect({selectionState:enums.wc.Normal}).fill().hex():unselectedFill||theme.rect({selectionState:enums.wc.Suppressed}).fill().hex()})),u.exit().remove()}}),[numberOfBins,width,height,data,selectedFill,unselectedFill,selectedRange,minDataValue,maxDataValue,theme]),(0,react.useEffect)((()=>{const elements=chartElements.current;if(elements){elements.viewPort.selectAll(".brush").remove(),elements.brushGroup=null;const brush=(0,src.n5)();if(brush.extent([[0,correctedMargins.top],[elements.vpWidth,elements.vpHeight+correctedMargins.bottom]]),elements.brushGroup=elements.viewPort.append("g").attr("class","brush").call(brush),selectedRange[0]||selectedRange[1]){const start=selectedRange[0]?selectedRange[0]:minDataValue,end=selectedRange[1]?selectedRange[1]:maxDataValue;brush.move(elements.brushGroup,[start,end].map(elements.xScale))}elements.onBrushEnd&&brush.on("end",elements.onBrushEnd)}}),[numberOfBins,width,height,data,selectedRange,minDataValue,maxDataValue,theme,correctedMargins.top,correctedMargins.bottom]),(0,jsx_runtime.jsx)("svg",{ref:svgElementRef})};try{HistogramSelect.displayName="HistogramSelect",HistogramSelect.__docgenInfo={description:"HistogramSelect displays a D3 SVG histogram that contains\na D3 brush",displayName:"HistogramSelect",props:{width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"number[]"}},numberOfBins:{defaultValue:null,description:"",name:"numberOfBins",required:!0,type:{name:"number"}},selectedRange:{defaultValue:null,description:"",name:"selectedRange",required:!0,type:{name:"[number, number]"}},onRangeChanged:{defaultValue:null,description:"",name:"onRangeChanged",required:!1,type:{name:"(range: [number, number]) => any"}},selectedFill:{defaultValue:null,description:"",name:"selectedFill",required:!1,type:{name:"string"}},unselectedFill:{defaultValue:null,description:"",name:"unselectedFill",required:!1,type:{name:"string"}},margins:{defaultValue:null,description:"",name:"margins",required:!1,type:{name:"{ top?: number; right?: number; bottom?: number; left?: number; }"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../components/src/ControlledHistogramFilter/HistogramSelect.tsx#HistogramSelect"]={docgenInfo:HistogramSelect.__docgenInfo,name:"HistogramSelect",path:"../components/src/ControlledHistogramFilter/HistogramSelect.tsx#HistogramSelect"})}catch(__react_docgen_typescript_loader_error){}const CHART_MARGINS={top:4,right:8,bottom:12,left:40},ControlledHistogramFilter=({name,data,width,height,selectedRange,onChange,selectedFill,unselectedFill})=>{const[bins,setBins]=(0,react.useState)(20),minValue=(0,react.useMemo)((()=>Math.min(...data)),[data]),maxValue=(0,react.useMemo)((()=>Math.max(...data)),[data]),[menuMin,setMenuMin]=(0,react.useState)(selectedRange[0]?selectedRange[0].toString():""),[menuMax,setMenuMax]=(0,react.useState)(selectedRange[1]?selectedRange[1].toString():"");(0,react.useEffect)((()=>{setMenuMin(selectedRange[0]?selectedRange[0].toString():""),setMenuMax(selectedRange[1]?selectedRange[1].toString():"")}),[selectedRange]);const validateTextFilter=value=>{if(""===value)return!0;try{return Number.parseFloat(value),!0}catch(err){return!1}},handleMinRange=(event,newValue)=>{onChange&&validateTextFilter(newValue||"")&&setMenuMin(newValue||"")},handleMaxRange=(event,newValue)=>{onChange&&validateTextFilter(newValue||"")&&setMenuMax(newValue||"")},clearFilter=()=>{onChange&&onChange([void 0,void 0])};return(0,jsx_runtime.jsxs)("div",{style:{width,display:"flex",flexDirection:"column"},children:[(0,jsx_runtime.jsxs)("div",{style:{width,height:32,display:"flex"},children:[(0,jsx_runtime.jsx)(lib_commonjs.Label,{style:{marginLeft:52+CHART_MARGINS.left,width:width-52-CHART_MARGINS.left,textAlign:"center"},children:name}),(0,jsx_runtime.jsx)(lib_commonjs.IconButton,{style:{border:"none",fontSize:"0.6em",justifySelf:"end"},iconProps:{iconName:"FilterSettings"},menuProps:{alignTargetEdge:!0,directionalHint:lib_commonjs.DirectionalHint.bottomRightEdge,onMenuDismissed:menu=>{const minV=""===menuMin?void 0:Number.parseFloat(menuMin),maxV=""===menuMax?void 0:Number.parseFloat(menuMax);minV===minValue&&maxV===maxValue||onChange&&onChange([minV,maxV])},items:[{key:"1",itemType:lib_commonjs.ContextualMenuItemType.Section,sectionProps:{title:"Histogram Settings",items:[{key:"bins",onRender:()=>(0,jsx_runtime.jsx)("div",{style:{marginLeft:8},children:(0,jsx_runtime.jsx)(NumberSpinButton.M,{label:"bins",value:bins,max:100,min:5,onChange:setBins,step:5})})}]}},{key:"2",itemType:lib_commonjs.ContextualMenuItemType.Section,sectionProps:{title:"Filter Settings",items:[{key:"minRange",onRender:()=>(0,jsx_runtime.jsx)("div",{style:{margin:10},children:(0,jsx_runtime.jsx)(lib_commonjs.TextField,{label:"min value",value:menuMin.toString(),onChange:handleMinRange})})},{key:"maxRange",onRender:()=>(0,jsx_runtime.jsx)("div",{style:{margin:10},children:(0,jsx_runtime.jsx)(lib_commonjs.TextField,{label:"max value",value:menuMax.toString(),onChange:handleMaxRange})})},{key:"clear",onRender:()=>(0,jsx_runtime.jsx)(lib_commonjs.Link,{onClick:clearFilter,style:{margin:10},children:"Clear Filter"})}]}}]}})]}),(0,jsx_runtime.jsx)(HistogramSelect,{width,height,margins:CHART_MARGINS,data,numberOfBins:bins,selectedRange,onRangeChanged:onChange,selectedFill,unselectedFill})]})};try{ControlledHistogramFilter.displayName="ControlledHistogramFilter",ControlledHistogramFilter.__docgenInfo={description:"ControlledHistogramFilter displays a histogram that contains\na D3 brush and basic numberical filtering with thematic theming",displayName:"ControlledHistogramFilter",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"number[]"}},width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},selectedRange:{defaultValue:null,description:"",name:"selectedRange",required:!0,type:{name:"[number, number]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(range: [number, number]) => any"}},selectedFill:{defaultValue:null,description:"",name:"selectedFill",required:!1,type:{name:"string"}},unselectedFill:{defaultValue:null,description:"",name:"unselectedFill",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../components/src/ControlledHistogramFilter/ControlledHistogramFilter.tsx#ControlledHistogramFilter"]={docgenInfo:ControlledHistogramFilter.__docgenInfo,name:"ControlledHistogramFilter",path:"../components/src/ControlledHistogramFilter/ControlledHistogramFilter.tsx#ControlledHistogramFilter"})}catch(__react_docgen_typescript_loader_error){}const ControlledHistogramFilter_stories={title:"@essex:components/ControlledHistogramFilter",component:ControlledHistogramFilter,args:{name:"name",width:600,height:400,data:[1,2,3,4,3,2,3,4,3,2,3,4,5,4,5,6,5,6,5,4,3,4,3,2,3,2,3,4,3,6,7,8,7,8,7,8,7,8,9,8,9,8,7,6,7,6,5,6]}},PrimaryComponent=args=>{const[selectedRange,setSelectedRange]=(0,react.useState)([void 0,void 0]);return(0,jsx_runtime.jsx)(ControlledHistogramFilter,{...args,selectedRange,onChange:range=>{setSelectedRange(range)}})},Primary={render:args=>(0,jsx_runtime.jsx)(PrimaryComponent,{...args}),name:"ControlledHistogramFilter"};Primary.parameters={...Primary.parameters,docs:{...Primary.parameters?.docs,source:{originalSource:"{\n  render: (args: ControlledHistogramFilterProps) => <PrimaryComponent {...args} />,\n  name: 'ControlledHistogramFilter'\n}",...Primary.parameters?.docs?.source}}}},"../components/src/NumberSpinButton/NumberSpinButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>NumberSpinButton});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../.yarn/cache/react-npm-18.3.1-af38f3c1ae-261137d3f3.zip/node_modules/react/jsx-runtime.js"),_fluentui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../.yarn/__virtual__/@fluentui-react-virtual-de7476e3d6/0/cache/@fluentui-react-npm-8.118.9-93c5d7c0a7-1806e7182f.zip/node_modules/@fluentui/react/lib-commonjs/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../.yarn/cache/react-npm-18.3.1-af38f3c1ae-261137d3f3.zip/node_modules/react/index.js");const NumberSpinButton=({label,value,min=Number.MIN_SAFE_INTEGER,max=Number.MAX_SAFE_INTEGER,step=1,onChange,labelPosition,incrementButtonAriaLabel,decrementButtonAriaLabel})=>{const handleChange=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((v=>{onChange&&v<=max&&v>=min&&onChange(v)}),[onChange,min,max]),handleIncrement=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((v=>{handleChange(Number.parseFloat(v)+step)}),[handleChange,step]),handleDecrement=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((v=>{handleChange(Number.parseFloat(v)-step)}),[handleChange,step]),handleValidate=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((v=>{handleChange(Number.parseFloat(v))}),[handleChange]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.SpinButton,{value:value.toString(),onIncrement:handleIncrement,onDecrement:handleDecrement,onValidate:handleValidate,label,min,max,step,labelPosition,incrementButtonAriaLabel,decrementButtonAriaLabel})};try{NumberSpinButton.displayName="NumberSpinButton",NumberSpinButton.__docgenInfo={description:"NumberSpinButton creates a thematic styled SpinButton from Fluent",displayName:"NumberSpinButton",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"number"}},min:{defaultValue:{value:"Number.MIN_SAFE_INTEGER"},description:"",name:"min",required:!1,type:{name:"number"}},max:{defaultValue:{value:"Number.MAX_SAFE_INTEGER"},description:"",name:"max",required:!1,type:{name:"number"}},step:{defaultValue:{value:"1"},description:"",name:"step",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(n: number) => any"}},labelPosition:{defaultValue:null,description:"",name:"labelPosition",required:!1,type:{name:"Position"}},incrementButtonAriaLabel:{defaultValue:null,description:"",name:"incrementButtonAriaLabel",required:!1,type:{name:"string"}},decrementButtonAriaLabel:{defaultValue:null,description:"",name:"decrementButtonAriaLabel",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../components/src/NumberSpinButton/NumberSpinButton.tsx#NumberSpinButton"]={docgenInfo:NumberSpinButton.__docgenInfo,name:"NumberSpinButton",path:"../components/src/NumberSpinButton/NumberSpinButton.tsx#NumberSpinButton"})}catch(__react_docgen_typescript_loader_error){}}}]);